--MySQL Solution using left join and CASE WHEN
