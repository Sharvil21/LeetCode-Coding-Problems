#Pandas Solution 
#First Join the two tables usiong .merge()
#Sort the values just in case
#Then create a column called rnk. The logic here is to rank the rows partitioned by each product_id for every year. Dense rank will be used, and the first year be will ranked 1.
